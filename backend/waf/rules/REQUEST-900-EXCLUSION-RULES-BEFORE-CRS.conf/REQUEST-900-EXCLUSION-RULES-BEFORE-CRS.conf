# Rate Limiting Rule (Add this at the top)
SecAction "id:900700,phase:1,nolog,pass,setvar:'tx.dos_burst_time_slice=60',setvar:'tx.dos_counter_threshold=100'"

# Custom Exclusions for Fastify
SecRule REQUEST_URI "@beginsWith /api" "id:1000,phase:1,nolog,pass,ctl:ruleEngine=Off"
SecRule REQUEST_HEADERS:Content-Type "@contains application/json" "id:1001,phase:1,nolog,pass,ctl:ruleEngine=Off"